# Odoo 18 Configuration File for Server Deployment
# Server IP: 75.119.141.141
# Port: 8070 (to avoid conflict with Odoo 17 on 8069)

[options]
# ========================================
# SERVER CONFIGURATION
# ========================================
# Main HTTP port (changed from 8069 to avoid conflict)
http_port = 8070

# XML-RPC port (also changed)
xmlrpc_port = 8072

# If you're behind a reverse proxy (nginx/apache)
proxy_mode = True

# Limit interface binding for security (uncomment if behind proxy)
# xmlrpc_interface = 127.0.0.1
# netrpc_interface = 127.0.0.1

# ========================================
# DATABASE CONFIGURATION
# ========================================
db_host = localhost
db_port = 5432

# IMPORTANT: Use different database user than Odoo 17
db_user = odoo18
db_password = YOUR_STRONG_PASSWORD_HERE

# Database filtering (security)
# Only allow databases starting with 'pharmacy_'
dbfilter = ^pharmacy_.*$

# Disable database manager in production
list_db = False
db_name = pharmacy_kenya

# ========================================
# PATHS
# ========================================
# CRITICAL: Include your custom addons path
# Make sure this path exists and contains pos_demo module
addons_path = /opt/odoo18/odoo/addons,/opt/odoo18/odoo/addons/custom

# Data directory
data_dir = /var/lib/odoo18

# ========================================
# LOGGING
# ========================================
logfile = /var/log/odoo18/odoo.log
log_level = info

# For debugging during deployment, use:
# log_level = debug

# Log handler format
# log_handler = :INFO

# ========================================
# PERFORMANCE TUNING
# ========================================
# Number of worker processes
# Formula: (CPU cores * 2) + 1
# For a 2-core server: (2 * 2) + 1 = 5
# But start with 4 for testing
workers = 4

# Maximum concurrent cron jobs
max_cron_threads = 2

# Memory limits (in bytes)
# 2.5 GB hard limit
limit_memory_hard = 2684354560
# 2 GB soft limit
limit_memory_soft = 2147483648

# Request limits
limit_request = 8192
limit_time_cpu = 600
limit_time_real = 1200
limit_time_real_cron = 0

# ========================================
# SECURITY
# ========================================
# Admin master password (CHANGE THIS!)
# Used for database operations
admin_passwd = CHANGE_THIS_MASTER_PASSWORD

# Disable database manager page
# list_db = False  # Already set above

# ========================================
# SESSION CONFIGURATION
# ========================================
# Session settings to avoid CSRF issues
# session_cookie_secure = False  # Set to True if using HTTPS
# session_cookie_httponly = True
# session_cookie_samesite = Lax

# ========================================
# STATIC FILE SERVING
# ========================================
# If behind nginx, nginx should serve static files
# Otherwise, Odoo will handle them

# ========================================
# MULTIPROCESSING
# ========================================
# Important for production with workers > 0
# Ensure PostgreSQL has enough connections
# max_connections in PostgreSQL should be >= (workers * 2) + 4

# ========================================
# DEBUGGING (Disable in production)
# ========================================
# dev_mode = False

# ========================================
# NOTES FOR DEPLOYMENT
# ========================================
# 1. Create directories:
#    sudo mkdir -p /var/lib/odoo18
#    sudo mkdir -p /var/log/odoo18
#    sudo chown -R odoo18:odoo18 /var/lib/odoo18 /var/log/odoo18
#
# 2. Create database user:
#    sudo -u postgres createuser -d -R -S odoo18
#    sudo -u postgres psql -c "ALTER USER odoo18 WITH PASSWORD 'password';"
#
# 3. Verify addons path exists:
#    ls -la /opt/odoo18/odoo/addons/custom/pos_demo
#
# 4. Set correct file ownership:
#    sudo chown -R odoo18:odoo18 /opt/odoo18/odoo/addons/custom
#
# 5. Start Odoo:
#    sudo systemctl start odoo18
#
# 6. Check logs:
#    sudo journalctl -u odoo18 -f
#
# 7. Access:
#    http://75.119.141.141:8070
